<!DOCTYPE html>
<html>

<header>
    <meta charset="UTF-8"> 
    <!-- use the CS559 Style Sheet -->
    <link rel="stylesheet" href="style559.css">
</header>

<body>

    <div id="box04" class="examplebox">
        <p>
            In box 3, we defined a function that got called when the window finished
            loading. If we wanted to do something else (like have a start function
            for this box) we can't just change <code>window.onload</code> again - since
            we'd over-write what we put there last time. Instead, we need to store whatever the
            previous value was and make sure it gets called as well. An example of
            how to do this is in the box. It uses a closure - which is something that you
            will learn about as you learn to program in JavaScript.
            We'll talk about them in class, and you can read about them if you aren't
            already familiar with them.
        </p>
        <script>
            // a function we want to have run after the page loads
            function mainfour () {
                console.log("Box 4: Something else to write to console");
            }
            // define another function - just to show how there are multiple ways
            // to define functions
            let mainfourb = function() {
                console.log("Box 4: Yet another line to write to console");
            }
            /**
             * define the "addStart" function that gives a new function to be
             * called at window.onload - but first calls the old handler
             * @param {function} func
             */
            function addStart(func) {
                // make a local variable and store the old value of the handler
                // this will be kept in closure when we define the new handler function
                let previousStart = window.onload;
                // define a new handler function and assign it to window.onload
                window.onload = function() {
                    // if no previous start was given, then its value will be undefined,
                    // so we cannot call it as a function
                    if (previousStart) previousStart();
                    // now we can call the function that we want to call
                    func();
                }
            }
            // now that we've defined addStart, let's use it
            addStart(mainfour);
            addStart(mainfourb);
        </script>
        <p>
            In the future, we will give you addStart, but this box is to explain
            why you need it, and to give you a first exposure to code with
            closures. While those few lines of code are short and simple, they
            use some important functional programming concepts.
            We will use similar things a lot in this class.
        </p>
        <p>
            And, in the future, don't put JavaScript into your HTML files like that.
        </p>
    </div>

</body>